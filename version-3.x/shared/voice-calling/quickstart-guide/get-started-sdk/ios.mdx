<PlatformWrapper platform="ios">

The Agora Voice SDK makes it easy to embed real-time voice interaction into iOS apps. It enables you to develop rapidly and easily to enhance your social, work, education and IoT apps.

This page shows the minimum code you need to add Voice Call into your app by using the Agora Voice SDK for iOS.


## Understand the tech

The following figure shows the workflow of a voice call implemented by the Agora SDK.

![1623991425414](https://web-cdn.agora.io/docs-files/1623991425414)

As shown in the figure, the workflow for adding Voice Call in your project is as follows:

1. Retrieve a token
A token is the credential that authenticates a user when your app client joins a channel. In a test or production environment, your app client retrieves tokens from a server in your security infrastructure.

2. Join a channel
Call `joinChannel` to create and join a channel. App clients that pass the same channel name join the same channel.

3. Publish and subscribe to audio in the channel
After joining a channel, the app client automatically publishes and subscribes to audio in the channel. 

For an app client to join an RTC channel, you need the following information:
- The App ID: A randomly generated string provided by Agora for identifying your app. You can get the App ID from [Agora Console](https://console.agora.io).
- The user ID: The unique identifier of a user. You need to specify the user ID yourself, and ensure that it is unique in the channel.
- A token: In a test or production environment, your app client retrieves tokens from a server in your security infrastructure. For this page, you use a temporary token with a validity period of 24 hours that you retrieve from Agora Console.
- The channel name: A string that identifies the channel for the voice call. 

## Prerequisites

~44a01050-0bcb-11ec-8e65-856920855d60~

## Project setup

In Xcode, follow the steps to create the environment necessary to add Voice Call into your app.

$$98945f90-0bcb-11ec-8e65-856920855d60
{
"sdk":"voice"
}
$$

## Implement a client for Voice Call

This section shows how to use the Agora Voice SDK to implement Voice Call in your app step by step.

### Implement the Voice Call logic

When your app opens, you create an `RtcEngine` instance, join a channel, and publish the local audio. When another user joins the channel, your app catches the join event and subscribes to the remote audio.

The following figure shows the API call sequence of implementing Voice Call. 

![](https://web-cdn.agora.io/docs-files/1638415710829)

To implement this logic, take the following steps:

1. Import the Agora kit and add the `agoraKit` variable.

   Modify your  `ViewController.swift` as follows:

    ```swift
    import UIKit
    // Add this line to import the Agora kit
    import AgoraRtcKit

    class ViewController: UIViewController {

        // Add this line to add the agoraKit variable
        var agoraKit: AgoraRtcEngineKit?

        override func viewDidLoad() {
            super.viewDidLoad()
        }

    }
    ```

2. Initialize the app and join the channel.

   Call the core methods to initialize the app and join a channel. In this example app, this functionality is encapsulated in the `initializeAndJoinChannel` function.

   In `ViewController.swift`, add the following lines after the `viewDidLoad` function, and fill in your App ID, temporary token, and channel name:

    ```swift
    func initializeAndJoinChannel() {
        // Pass in your App ID here
        agoraKit = AgoraRtcEngineKit.sharedEngine(withAppId: "Your App ID", delegate: self)
        
        // Join the channel with a token. Pass in your token and channel name here
        agoraKit?.joinChannel(byToken: "Your token", channelId: "Channel name", info: nil, uid: 0, joinSuccess: { (channel, uid, elapsed) in
        })
    }
    ```

3. Add the callback that is triggered when a remote user joins the channel.
   In `ViewController.swift`, add the following lines after the `ViewController` class:

    ```swift
    extension ViewController: AgoraRtcEngineDelegate {
        func rtcEngine(_ engine: AgoraRtcEngineKit, didJoinedOfUid uid: UInt, elapsed: Int) {
        }       
    }
    ```

### Start and stop your app

Now you have created the Voice Call functionality, add the functionality of starting and stopping the app. In this implementation, a voice call starts when the user opens your app. The call ends when the user closes your app.

To implement the functionality of starting and stopping the app:

1. When the view is loaded, call `initializeAndJoinChannel` to join a voice call channel.

   In `ViewController.swift`, add the `initializeAndJoinChannel` function inside the `viewDidLoad` function:

    ```swift
    override func viewDidLoad() {
        super.viewDidLoad()
        // Add this line
        initializeAndJoinChannel()
    }
    ```
   
2. When the user closes this app, clean up all the resources used by your app.

   In `ViewController.swift`, add `viewDidDisappear` after the `initializeAndJoinChannel` function.

    ```swift
    override func viewDidDisappear(_ animated: Bool) {
        super.viewDidDisappear(animated)
        agoraKit?.leaveChannel(nil)
        AgoraRtcEngineKit.destroy()
    }
    ```

## Test your app

To test your app on a physical device, do the following:

1. Check whether you fill in your App ID, temporary token, and channel name in `ViewController.swift`.
2. Connect an iOS device to your computer.
3. In Xcode, choose the device from the scheme menu in the [toolbar](https://help.apple.com/xcode/mac/current/#/devf0d1df47a), and click the Run button.
4. On your device, launch the app and grant microphone access.
5. Ask a friend to join the voice call with you on the [demo app](https://webdemo.agora.io/basicVideoCall/index.html). Your friend needs to enter the same App ID and channel name.
   When your friend joins the channel, you can hear each other.

## Next steps

Generating a token by hand is not helpful in a production context. [Authenticate Your Users with Tokens](https://docs.agora.io/en/Interactive%20Broadcast/token_server?platform=All%20Platforms) shows you how to start Voice Call with a token that you retrieve from your server.

## See also

This section provides additional information for your reference: 

### Sample project

Agora provides an open source sample project [Basic Audio Call](https://github.com/AgoraIO/Basic-Audio-Call) on GitHub that implements one-to-one voice call and group voice call for your reference.

<a name="othermethods"></a>

### Other approaches to integrate the latest SDK

$$43c37680-0bcc-11ec-8e65-856920855d60
{
"sdk":"voice"
}
$$

$$47c8b5f0-3392-11eb-a7de-5fbc720708f8
{
 "product": "voice"
}
$$


<a name="oc"></a>

### Objective-C code sample

To implement Voice Call in your app using Objective-C:

1.Replace the contents in the  `ViewController.h` file with the following:

```objective-c
#import <UIKit/UIKit.h>
#import <AgoraRtcKit/AgoraRtcEngineKit.h>

    @interface ViewController : UIViewController <AgoraRtcEngineDelegate>
@property (strong, nonatomic) AgoraRtcEngineKit *agoraKit;

@end
```

2.Replace the contents in the `ViewController.m` file with the following:

```objective-c
#import "ViewController.h"
#import <UIKit/UIKit.h>

@interface ViewController ()

@end

@implementation ViewController

- (void)viewDidLoad {
    [super viewDidLoad];
    [self initializeAndJoinChannel];
}

- (void)initializeAndJoinChannel {
    // Pass in your App ID here
    self.agoraKit = [AgoraRtcEngineKit sharedEngineWithAppId:@"Your App ID" delegate:self];
    [self.agoraKit joinChannelByToken:@"Your token" channelId:@"Channel name" info:nil uid:0 joinSuccess:^(NSString * _Nonnull channel, NSUInteger uid, NSInteger elapsed) {
    }];
}

- (void)rtcEngine:(AgoraRtcEngineKit *)engine didJoinedOfUid:(NSUInteger)uid elapsed:(NSInteger)elapsed {
    
}

- (void)viewDidDisappear:(BOOL)animated {
    [super viewDidDisappear:animated];
    [self.agoraKit leaveChannel:nil];
    [AgoraRtcEngineKit destroy];
}

@end

```

</PlatformWrapper>