<PlatformWrapper platform="react-native">

This page provides the release notes for the Agora React Native SDK.

## Known issues and limitations

#### Compatibility with iOS 15 (iOS only)

As of v3.4.6, the SDK supports iOS 15. For the SDK versions between v3.2.1 and v3.4.5 inclusive, crashes occur on iOS 15. To fix this issue, upgrade the SDK to v3.4.6 or later.

## v3.7.0

v3.7.0 was released on May 14, 2022.

#### Compatibility changes

**Changes to the implementation fields of dynamic libraries (Android)**

When you integrate the SDK, you can reduce the size of your app after integrating the SDK by modifying the `implementation` field in `dependencies` in the `/android/app/build.gradle` file to specify the desired dynamic libraries. See [Reduce App Size](../best-practices/reduce-app-size#remove-extension-libraries-when-using-maven-central) for details.

To simplify the `implementation` fields, this release changes the `implementation` fields of the following dynamic libraries:

| Dynamic libraries                                            | `implementation` field(v3.6.2)      | `implementation` fieldï¼ˆv3.7.0 and later) |
| :----------------------------------------------------------- | :---------------------------------- | :---------------------------------------- |
| Deep-learning noise reduction library:`libagora_ai_denoise_extension.so` | io.agora.rtc:full-ains              | io.agora.rtc::ains                        |
| Full-format audio decoding library:`libagora_full_audio_format_extension.so` | io.agora.rtc:full-full-audio-format | io.agora.rtc:full-audio-format            |

#### New features

**Spatial audio effect**

This release adds the feature of spatial audio effect, which can add a sense of space to remote users' audio and simulate the audio transmission process in the real world. This enables the local user to hear remote users with the spatial audio effect.

To use this feature, contact [support@agora.io](mailto:support@agora.io).

**Screen sharing**

This release supports screen sharing on the Android and iOS platforms and provides the `startScreenCapture`, `stopScreenCapture`, and `updateScreenCaptureParameters` methods for this purpose. For the implementation guide, see [Share the Screen](/basic-features/screensharing).

**Local voice pitch**

This release adds the `enableLocalVoicePitchCallback` method and the `LocalVoicePitchInHz` callback, to allow the SDK to report the voice pitch of the local user at the set time interval to the app.

**Reporting the first remote video frame rendered**

This release adds the `FirstRemoteVideoFrame` callback to the `RtcChannelEvents` class to report to the local user that the first video frame of the remote user has been rendered in a multichannel scenario. You can also get the remote user ID, the width and height (px) of the video, and the time (in milliseconds) to render the first video frame from this callback.

**Reporting the user role switch failure**

This release adds the `ClientRoleChangeFailed` callback to report the reason for a user role switch failure and the current user role in the interactive live streaming.

**Reasons for connection state changes**

To help users better understand the cause of connection state changes, this release adds the following enumerators in `ConnectionChangedReason`:

- `SameUidLogin(19)`: Join the same channel from different devices using the same user ID.
- `TooManyBroadcasters(20)`: The number of hosts in the channel reaches the upper limit. This enumerator is reported only after the support for 128 hosts is enabled.

#### Improvements

**Channel capacity improvement**

As of this release, a single channel can support up to 128 concurrent online hosts, who can publish audio and video streams at the same time. The number of audience members in a channel is unlimited. Each host or audience member can subscribe to a maximum of 50 hosts at the same time.

To experience this improvement, contact [support@agora.io](mailto:support@agora.io).

**Virtual background**

Test results and user feedback show that the effect of the virtual background feature improves when a user is against a complex background and adopts a more casual pose. As a result, virtual background is converted from a beta feature to an official feature as of v3.7.0.

**A new version of deep-learning noise reduction**

Agora has added the option of using a new version of deep-learning noise reduction to further improve audio quality. To experience this feature, contact [support@agora.io](mailto:support@agora.io).

**playEffect improvements**

This release improves the internal implementation logic of `playEffect` to avoid blocking and reduce freezing when playing an audio effect file.

**Audio experience optimization** 

This release reduces audio stuttering under network conditions with burst jitter and high packet loss.

**Transmission upgrade**

This release upgrades transmission protocols and algorithms to enhance the SDK's ability to counter poor network conditions. At the same time, this release optimizes the scalable video coding capability for multi-user video scenarios to improve user video experience.

#### Issues fixed

This release fixed an issue where the app occasionally failed to rejoin a channel after a user left a channel and put the app in the background for a period of time. (iOS)

#### API changes

**Added**

- [`startScreenCapture` ](https://api-ref.agora.io/en/video-sdk/react-native/3.x/v3.7.0/classes/rtcengine.html#startscreencapture)
- [`stopScreenCapture`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/v3.7.0/classes/rtcengine.html#stopscreencapture)
- [`updateScreenCaptureParameters`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/v3.7.0/classes/rtcengine.html#updatescreencaptureparameters)
- [`enableLocalVoicePitchCallback`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/v3.7.0/classes/rtcengine.html#enablelocalvoicepitchcallback)
- [`LocalVoicePitchInHz`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/v3.7.0/interfaces/rtcengineevents.html#localvoicepitchinhz)
- [`FirstRemoteVideoFrame`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/v3.7.0/interfaces/rtcchannelevents.html#firstremotevideoframe) in `RtcChannelEvents` 
- [`ClientRoleChangeFailed`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/v3.7.0/interfaces/rtcengineevents.html#clientrolechangefailed)
- `SameUidLogin(19)` and `TooManyBroadcasters(20)` in [`ConnectionChangedReason`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/v3.7.0/enums/connectionchangedreason.html)
- The following constants in [`LocalVideoStreamError`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/v3.7.0/enums/localvideostreamerror.html):
  - (iOS) `ExtensionCaptureStarted(13)`
  - (iOS) `ExtensionCaptureStoped(14)`
  - (iOS) `ExtensionCaptureDisconnected(15)`
  - (Android) `ScreenCapturePermissionDenied(16)`


**Deprecated**

- Error code `SetClientRoleNotAuthorized(119)`. Use `ClientRoleChangeFailedReason` instead.

## v3.6.2 

v3.6.2 was released on April 13, 2022.

#### Compatibility changes

**Media Push**

To reduce the difficulty of integrating Media Push, this release optimizes the API design of Media Push and improves the handling of network issues within Media Push clients and servers. You can experience the optimized Media Push functionality with the following new methods:

- `startRtmpStreamWithoutTranscoding`: Starts pushing media streams to a CDN without transcoding. This method works the same as the old method `addPublishStreamUrl(false)`.
- `startRtmpStreamWithTranscoding`: Starts pushing media streams to a CDN and sets the transcoding configuration. This method works the same as calling the old methods `setLiveTranscoding` and `addPublishStreamUrl(true)` in sequence.
- `updateRtmpTranscoding`: Updates the transcoding configuration. This method works the same as the non-first call to the old method `setLiveTranscoding`.
- `stopRtmpStream`: Stops pushing media streams to a CDN. This method works the same as the old method `removePublishStreamUrl`.

This release deprecates three old methods for Media Push: `addPublishStreamUrl`, `setLiveTranscoding`, and `removePublishStreamUrl`. Agora recommends that you use the new methods for Media Push and update your code logic by referring to [Media Push](/en/3.x/interactive-live-streaming/advanced-features/media-push).

Also, as of this release, whether you use the new or old methods for Media Push, you can experience the following improvements:

- Reporting streaming states, errors, and events:

  - In the `RtmpStreamingState` state code, adding `Disconnecting(5)`: The SDK is disconnecting from the Agora streaming server and CDN. When you call `remove` or `stop` to stop the streaming normally, the SDK reports the streaming state as `Disconnecting`, `Idle` in sequence.

  - Adding the following to the `RtmpStreamingErrorCode` error code:

    - `NotBroadcaster(11)`: The user role is not host, so the user cannot use the Media Push function. Check your application code logic.
    - `TranscodingNoMixStream(13)`: The `update` or `setLiveTranscoding` method is called to update the transcoding configuration in a scenario where there is streaming without transcoding. Check your application code logic.
    - `NetDown(14)`: Errors occurred in the host's network.
    - `InvalidAppid(15)`: Your App ID does not have permission to use the Media Push function. Refer to [Prerequisites](/en/3.x/interactive-live-streaming/advanced-features/media-push#prerequisites) to enable the Media Push permission.

  - Adding the following to the `RtmpStreamingEvent` event code:

    - `AdvancedFeatureNotSupport(3)`: The feature is not supported.
    - `RequestTooOften(4)`: Reserved.

 <div class="alert note">To ensure the quality of the Media Push, make sure to handle the business logic according to the state code, error code, and event code.</div>

- Adding multiple watermarks and background images during streaming with transcoding: This is achieved by adding `watermarkList` and `backgroundImageList` to the `LiveTranscoding` class.

- Setting the layer number and transparency of each watermark and background image during streaming with transcoding: This is achieved by adding `zOrder` and `alpha` to the `AgoraImage` structure.

- Using the HE-AAC v2 audio codec during streaming with transcoding: This is achieved by adding `HE_AAC_V2` to `AudioCodecProfileType`.

#### New features

**1. Removing extension libraries**

Extension libraries are dynamic libraries that can be optionally integrated into a project. As of v3.6.2, when you integrate the Android or iOS SDK, you can reduce the size of your app after integrating the SDK by specifing the desired dynamic libraries and excluding unnecessary extension libraries. To achieve this, do the following based on your target platform:

- Android: Modify `dependencies` in the `/android/app/build.gradle` file. For details about the sample code and the `implementation` field in `dependencies`, see [Remove extension libraries when using Maven Central](../best-practices/reduce-app-size#remove-extension-libraries-when-using-maven-central) in Reduce App Size.
- iOS: Use the `subspecs` field in the `/ios/Podfile` file. For details about the sample code and the `subspecs` fields, see [Remove extension libraries when using CocoaPods](../best-practices/reduce-app-size#remove-extension-libraries-when-using-cocoapods) in Reduce App Size.

**2. Video enhancement**

In addition to the image enhancement feature, Agora adds support for more video enhancement features:

- Video noise reduction: This feature reduces video noise and improves video quality. You can use the `setVideoDenoiserOptions` method to enable/disable video noise reduction and set the options of the video noise reduction effect.
- Low-light enhancement: This feature adaptively adjusts the brightness value of the video captured in situations with low or uneven lighting, such as backlit, cloudy, or dark scenes. It restores or highlights the image details and improves the overall visual effect of the video. You can use the `setLowLightEnhanceOptions` method to enable/disable low-light enhancement and set the options of the low-light enhancement effect.
- Color enhancement: This feature intelligently adjusts video characteristics such as saturation and contrast to enhance the video color richness and color reproduction, making the video more vivid. You can use the `setColorEnhanceOptions` method to enable/disable color enhancement and set the options of the color enhancement effect.

<div class="alert note"><ul><li>Before you use these video enhancement features, ensure that the following dynamical library is integrated: <ul><li>Android: <code>libagora_video_process_extension.so</code></li><li>iOS: <code>AgoraVideoProcessExtension.xcframework</code></li></ul></li><li>These video enhancement features have certain performance requirements on devices. If your device begins to overheat after you enable video enhancement, modify the video enhancement options to a less performance-consuming level or disable video enhancement.</li></ul></div>

**3. Loading .so files dynamically**

This release adds the `setAgoraLibPath` method for setting the directory of `.so` files. After a successful method call, the SDK dynamically loads `.so` files based on your specified directory when the app is running. This feature can help reduce the size of your app package. For detailed instructions, see [Reduce App Size](../best-practices/reduce-app-size#load-so-files-dynamically).

**4. Audio and video recording on the client**

To enable users to record local audio and video on their client, this release adds the following methods and callbacks:

- `startRecording`: Sets the recording content, duration, format of generated files, and callback interval, and enables the local audio and video recording. This method supports recording the following content:

  - The audio captured by the local microphone and encoded in AAC format by the SDK.
  - The video captured by the local camera and encoded by the SDK.

  The generated recording files are saved in the local path specified by the user.

- `stopRecording`: Stops recording the local audio and video.

- `onRecorderStateChanged`: Occurs when the recording state changes.

- `onRecorderInfoUpdated`: Occurs when the recording information is updated.

<div class="alert note">In the <code>COMMUNICATION</code>  channel profile, this function is incompatible with versions of the SDK earlier than v3.0.0.</div>

#### Improvements

**1. Cloud proxy**

To enrich application scenarios of the Agora Cloud Proxy, this release updates the cloud proxy types as follows:

- Changes the meaning of `None(0)` from "Do not use the cloud proxy" to "Automatic mode". In this mode, the SDK attempts a direct connection to SD-RTNâ„¢ and automatically switches to TLS 443 if the attempt fails. As of v3.6.2, the SDK has this mode enabled by default.
- Adds `TCP(2)`, which is the TCP (encrypted) mode. In this mode, the SDK always transmits data over TLS 443.

In addition, this release adds the `ProxyConnected` callback to report the proxy connection state. For example, when a user calls `setCloudProxy` and joins a channel successfully, the SDK triggers this callback to report the user ID, the proxy type connected, and the time elapsed from the user calling `joinChannel` until this callback is triggered.

**2. Audio recording**

This release extends `startAudioRecordingWithConfig` with support for setting recording with dual channels and higher audio quality.

- By adding `recordingChannel` to `AudioRecordingConfiguration`, it enables you to set the recorded audio channel to be mono or dual. Because the actual recorded audio channel is related to the captured audio channel and the integration scheme affects the final recorded audio channel, contact technical support for assistance with stereo recording using `startAudioRecording`.
- By adding `UltraHigh(3)` to `AudioRecordingConfiguration.recordingQuality`, it enables you to set the recorded audio quality to ultra-high. Ultra-high quality is the highest quality available in `recordingQuality`. When you record a 10-minute AAC audio file at a sample rate of 32,000 Hz and ultra-high quality, the file size is approximately 7.5 MB.

**3. Music file playback**

This release optimizes the experience of calling `startAudioMixing` to play music files as follows:

- Reduces issues of audio freezes or no audio when playing music files.
- Increases the accuracy of the audio duration reported by `getAudioFileInfo`.
- Supports more audio file formats. See [Which audio file formats does the Agora <Vg k="VSDK" /> support](https://docs.agora.io/en/help/general-product-inquiry/audio_format).

If you want to experience these improvements, ensure that you have integrated the following dynamic library:

- Androidï¼š`libagora-full-audio-format-extension.so`
- iOSï¼š`AgoraFullAudioFormatExtension.xcframework`

Given the large size of this library, if you have limitations on app size and do not need these improvements, you can remove this dynamic library when integrating the SDK. For more instructions, see [Reduce App Size](../best-practices/reduce-app-size#extension-libraries).

**4. Audio file formats (iOS only)**

This release adds support for playing audio files in the following formats:

- Mono-track online files in MP4 format.
- Multi-track online files in M4A and MP4 formats.

For online MP4 and M4A files, the MOOV atom must be before the MDAT atom.

**5. Audio device errors**

To convey the impact of iOS system call on the audio sampling, `Interrupted(8)` in `Interrupted(8)` supports the iOS platform.

**6. Image enhancement**

This release updates the Agora image enhancement algorithm to improve the image enhancement effects that you can enable by calling `setBeautyEffectOptions`. To balance these image enhancement effects, this release changes the default value of `lighteningLevel` from 0.7 to 0.6 and adds `sharpnessLevel` to the `BeautyOptions` structure to support setting the sharpness level.

As of this release, ensure that you have integrated the following dynamic library before calling `setBeautyEffectOptions`:

- Android: `libagora_video_process_extension.so`
- iOS: `AgoraVideoProcessExtension.xcframework`

Otherwise, you cannot experience the optimized image enhancement effects and sharpness adjustment brought out by the updated Agora image enhancement algorithm, but only the image enhancement effects brought out by the older Agora image enhancement algorithm.

**7. Rendering of the first remote video frame**

This release speeds up rendering of the first remote video frame under poor network conditions to enhance user video experience.

**8. Other improvements**

This release also provides the following improvements:

- After a remote user using a Mac device leaves a channel due to the leaveChannel method call, network interruption, or other reasons, the local user sees the remote view stay on the last video frame instead of the remote view directly disappearing as in previous versions.
- Adds the fallback to software encoding when hardware encoding fails for the custom video in texture format, in order to improve the usability of video functions. (Android only)
- Optimizes video rendering methods, which improves compatibility. (iOS only)


#### Fixed issues

This release fixed the following issues:

**Android and iOS**

- When an end user muted and unmuted audio from an application using the Agora Web SDK, end users using an application with Native SDK version 3.6.0 might not hear audio from this end user.
- The CDN live streaming failed because of the abnormal resolution of the RTMP streaming URL with a port number.
- Occasionally, the video received by remote users froze after you enabled media stream encryption.
- When you were playing an original song, calling `setAudioMixingPitch` to adjust the pitch caused the played song to switch to accompaniment.
- Occasional crashes occurred.

**Android only**

- This release fixed the issue that under certain circumstances, zipping noises occurred when using a Redmi 4A phone for live streaming.
- On some devices, occasional crashes occurred after you enabled the virtual background.
- On some devices, occasional noises occurred when you used OpenSL.
- The SDK caused the Bluetooth to restart and triggered the prompt to turn off the bluetooth when the SDK detected incorrect settings of the Bluetooth.
- In the `Education` scenario, occasionally the volume became unstable when the user called `enableLocalAudio` to enable and disable the local audio capture.

**iOS only**

- Under certain circumstances, local users could see a blurry screen for remote users after switching back to the app from the home screen.
- When playing a specific audio file in the WAV format with the `startAudioMixing` method, there was no sound after a certain period of playback.
- Audio stuttered under high jitter networks.
- Under poor network conditions, you could receive the `AudioMixingStateChanged` callback only after a three-second delay after a successful call to `startAudioMixing`.
- When adding a watermark with the `addVideoWatermark` method, under certain circumstances, the watermark color was different from the original color.
- After you enabled Bitcode settings in Xcode and integrated the `AgoraVideoProcessExtension.xcframework` dynamic library, errors occurred when you uploaded the app to the Apple App Store.
- Occasionally failed to start the camera and video capture due to a system issue that prevented the SDK from getting the device name of the camera.
- The `startAudioMixing` method call failed to play local iTunes music files starting with `"ipod-library://"`.
- When the host in the channel switched their role to `Audience` and then back to `Broadcaster`, the audience heard the host's voice with a voice change effect.
- After a user played music with a third-party music player and set the audio scenario to `ChatRoomGaming`, joining a channel could interrupt the music played by the third-party music player.
- Remote users could not see the shared screen video during the local user's screen sharing.
- Remote users saw the screen shared by the local user flicker.

#### API changes

**Added**

- `setVideoDenoiserOptions`
- `setLowLightEnhanceOptions`
- `setColorEnhanceOptions`
- `setAgoraLibPath`
- `recordingChannel` in `AudioRecordingConfiguration`
- `UltraHigh(3)` in `AudioRecordingConfiguration.recordingQuality`
- `ProxyConnected`
- `TCP (2)` in `CloudProxyType`
- `startRtmpStreamWithoutTranscoding`
- `startRtmpStreamWithTranscoding`
- `updateRtmpTranscoding`
- `stopRtmpStream`
- `Disconnecting(5)` in `RtmpStreamingState` of `RtmpStreamingStateChanged`
- The following code in `RtmpStreamingErrorCoder` of `RtmpStreamingEvent`:
  - `NotBroadcaster(11)`
  - `TranscodingNoMixStream(13)`
  - `NetDown(14)`
  - `InvalidAppid(15)`
- The following code in `eventCode` of `RtmpStreamingEvent`:
  - `AdvancedFeatureNotSupport(3)`
  - `RequestTooOften(4)`
- The following properties in the `LiveTranscoding` class:
  - `watermarkList`
  - `backgroundImageList`
- `zOrder` and `alpha` in `AgoraImage` 
- `HE_AAC_V2` in `AudioCodecProfileType`
- `sharpnessLevel` in `BeautyOptions`
- `startRecording`
- `stopRecording`
- `RecorderStateChanged`
- `RecorderInfoUpdated`

**Modified**

- The behavior of `None(0)` in `CloudProxyType` 
- Changed the default value of `lighteningLevel` from `0.7` to `0.6`

## v3.5.2

v3.5.2 was released on January 29, 2022. 

#### Compatibility changes

**1. Error codes returned when the request to join a channel is rejected**

To more accurately report the reason for the failure to join a channel, as of this release, the SDK returns the error code `-17 (JoinChannelRejected)` instead of `-5 (Refused)` in the following situations:

- When a user who has already joined an `RtcEngine` channel calls the joining channel method of the `RtcEngine` class with a valid channel name.

- When a user who has already joined an `RtcChannel` channel calls the joining channel method of this `RtcChannel` object.

**2. Selecting Bluetooth profiles**

To ensure connectivity with Bluetooth headsets, as of this release, when a user in the communication profile or a host in the interactive streaming profile uses a Bluetooth headset, the SDK checks whether the device supports the Hands-Free Profile (HFP), and selects the Bluetooth profile based on the result as follows:

- On a device that supports HFP, the SDK uses HFP, where the audio is captured and played through the Bluetooth headset.
- On a device that does not support HFP, the SDK changes to the Advanced Audio Distribution Profile (A2DP), where the audio is captured through device's microphone and played through the Bluetooth headset.

#### New features

**1. Video snapshot**

This release adds the `takeSnapshot` method for taking a snapshot of a video stream from the specified user, generating a JPG image, and saving it to the specified path. After a successful method call, the SDK triggers the `SnapshotTaken` callback to report whether the snapshot is successfully taken as well as the details of the snapshot taken.

**2. Super resolution (beta)**

To effectively boost the resolution of a remote user's video seen by the local user, this release adds support for the super resolution feature. You can call `enableRemoteSuperResolution` to enable super resolution. The SDK triggers the `UserSuperResolutionEnabled` callback to report whether this feature has been successfully enabled. If it is not enabled successfully, use the `reason` code to troubleshoot issues.

<div class="alert note">Before using super resolution, ensure that the device performance, number of remote users, and original resolution of remote user's video meet the requirements. For details, see the <a href="https://api-ref.agora.io/en/video-sdk/react-native/3.x/classes/rtcengine.html#enableremotesuperresolution">enableRemoteSuperResolution</a > documentation.</div>

**3. Background blurring**

To enrich the virtual background effects, this release adds support for setting background blur when a user enables the virtual background function by calling `enableVirtualBackground`. You need to set the type of the custom background image as `Blur` and set `blur_degree` according to the degree of blurring that the user desires.

**4. Pausing and resuming the media stream relay across channels**

In order to enable the host to quickly pause or resume a cross-channel media stream relay, this release adds the following methods:

- `pauseAllChannelMediaRelay`: Pauses the media stream relay to all destination channels.
- `resumeAllChannelMediaRelay`: Resumes the media stream relay to all destination channels.
After a successful method call of `pauseAllChannelMediaRelay` or `resumeAllChannelMediaRelay`, the SDK triggers the `ChannelMediaRelayEvent` callback to report whether the media stream relay is successfully paused or resumed.

**5. Advanced settings of the music file**

To set the playback speed, audio track, and channel mode of a music file, this release adds the following methods:

- `setAudioMixingPlaybackSpeed`: Sets the playback speed of the current music file. Agora recommends a value range of [50,400], where 100 represents the original speed.
- `getAudioTrackCount`: Gets the number of audio tracks of the current music file.
- `selectAudioTrack`: Specifies the playback audio track of the current music file. The range of index is [0, `getAudioTrackCount()`).
- `setAudioMixingDualMonoMode`: Sets the channel mode of the current music file to original mode, left channel mode, right channel mode, or mixed channel mode.

**6. Getting audio file information**

To get the information of any audio file, this release deprecates `getAudioMixingDuration` and adds `getAudioFileInfo` instead. After joining a channel, you can call `getAudioFileInfo` and get information such as duration for the specified audio file in `RequestAudioFileInfo`.

#### Improvements

**1. Testing audio call loop**

To check whether the local audio device and network conditions can guarantee the proper sending and receiving of audio streams as well as to secure the test, this release adds the `config` parameter in `startEchoTest`. You can call this method before joining a channel to test whether the loop of a user's audio devices and network conditions are working properly.

**2. Identification and quality testing for 5G mobile networks**

This release adds identification and connection quality testing for 5G mobile networks:

- Adds `Mobile5G (6)`. When the local network changes to 5G, the SDK triggers the `NetworkTypeChanged` callback to report this network connection type.
- Supports calling `enableLastmileTest` or `startLastmileProbeTest` to test the connection quality of the 5G mobile network.

**3. Adapting OpenSL**

This release adapts OpenSL to reduce the audio delay. It also adds a blacklist to disable OpenSL and enable Java adm on some devices that do not support OpenSL in order to improve the stability of audio functions.

**4. Performance improvements**

This release slightly reduces CPU usage in video scenarios by optimizing the FEC (Forward Error Correction) codec.

**5. Experience improvements**

This release improves video sharpness and smoothness under poor network conditions by optimizing the congestion control algorithm.

**6. Other improvements**

This release also provides the following improvements:

- Adds continuous optimization of the portrait edge effect of the virtual background.
- After enabling deep-learning noise reduction, the audio experience is improved when using some Bluetooth headsets.

#### Fixed issues

This release fixed the following issues:

**Android and iOS**

- The video bitrate failed to climb when a user joined a channel in poor network conditions with high packet loss.
- The video sharpness and smoothness degraded significantly due to a cliff-like drop in video bitrate under certain poor network conditions.
- Remote users heard slightly unsynchronized voice and music when a user called `startAudioMixing` on some Android devices.
- In the `GameStreaming` scenario, occasional echo or noise that was caused by inaccurate music detection occurred.
- The local user occasionally saw the remote user with a short black screen after the remote user called `enableLocalVideo(false)`, `enableLocalVideo(true)` to disable and enable local video capture or called `muteLocalVideoStream(true)`, `muteLocalVideoStream(false)` to stop and resume sending local video in sequence within a few seconds.
- When the local user called `muteAllRemoteAudioStreams` and received `onRemoteAudioStateChanged` (`RemoteMuted`), `RemoteAudioStateChanged` (`RemoteMuted`) was incorrectly received after 15 seconds.
- Crashes occasionally occurred in audio scenarios.
- As of v3.4.5, the return value was inaccurate when you called `joinChannel` multiple times in a row.
- When the host used a specific low-end device under certain circumstances, the audience watching the host's video occasionally experience lag.
- Under certain circumstances, when the sender used certain Xiaomi or Redmi devices, the receiver occasionally saw a mosaic square on the received video.
- When the sender used certain Android emulators, the local video or the video received by the receiver was abnormal.
- The SDK additionally triggered the `LocalAudioStateChanged` callback to report `Recording(1)` when you called `enableLocalAudio(false)` after joining a channel.

**Android only**

- Updating the transcoding layout in CDN live streaming occasionally failed under certain circumstances.
- When using an app integrated with the SDK for real-time communication, if a user answered a system call and returned to the app, the audio route of the SDK changed. For example, when the audio was played through the speaker in the app, if a user answered a system call through the earpiece and returned to the app, the audio route of the SDK changed to the earpiece.
- When a user with the audio profile `MusicHighQualityStereo (5)` talked to a user with another audio profile, the latter was likely to hear a zipping noise.
- When a Bluetooth headset and a wired headset were connected to the audio playback device at the same time, the SDK did not trigger `AudioRouteChanged` after plugging and unplugging the wired headset multiple times.

**iOS only**
- When `pauseAudioMixing` was called before playing an audio file, and then `startAudioMixing` was called to play the audio file, playback failed.
- The local user occasionally could not hear remote users after calling `setAudioSessionOperationRestriction`.

#### API changes

**Added**

- [`takeSnapshot`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/classes/rtcengine.html#takesnapshot)
- [`SnapshotTaken`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/interfaces/rtcchannelevents.html#snapshottaken)
- [`enableRemoteSuperResolution`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/classes/rtcengine.html#enableremotesuperresolution)
- [`UserSuperResolutionEnabled`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/interfaces/rtcchannelevents.html##a4437c6d4d04135837ddf79ce050132a0)
- `blur_degree` and `VirtualBackgroundBlurDegree` in [`VirtualBackgroundSource`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/classes/virtualbackgroundsource.html)
- `Blur` in [`backgroundSourceType`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/classes/virtualbackgroundsource.html#backgroundsourcetype)
- [`setAudioMixingPlaybackSpeed`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/classes/rtcengine.html#setaudiomixingplaybackspeed)
- [`getAudioTrackCount`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/classes/rtcengine.html#getaudiotrackcount)
- [`selectAudioTrack`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/classes/rtcengine.html#selectaudiotrack)
- [`setAudioMixingDualMonoMode`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/classes/rtcengine.html#a81b6a0f46612a6c4337d078b3af1681a)
- [`pauseAllChannelMediaRelay`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/classes/rtcengine.html#pauseallchannelmediarelay)
- [`resumeAllChannelMediaRelay`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/classes/rtcengine.html#resumeallchannelmediarelay)
- [`getAudioFileInfo`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/classes/rtcengine.html#getaudiofileinfo)
- [`RequestAudioFileInfo`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/interfaces/rtcchannelevents.html#requestaudiofileinfo)
- `Mobile5G(6)`in [`NetworkType`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/enums/networktype.html)

**Modified**

- [`startEchoTest`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/classes/rtcengine.html#startechotest)

**Deprecated**

- `getAudioMixingDuration`

## v3.5.0 (Native 3.5.0.3)

v3.5.0 was released on September 15, 2021.

#### Compatibility changes

**Changes to audio route behavior** (Android only)

To improve user experience, this release improves the following SDK behavior:

- When the SDK uses the media volume, the audio route is affected as follows:

  - With versions earlier than v3.5.0, the SDK cannot set the audio route as the earpiece.
  - With v3.5.0 and later versions, the SDK can set the audio route as the earpiece. At the same time, the volume type becomes in-call volume. If you switch the audio route to the speakerphone, the SDK sets the volume type back to the media volume.

  <div class="alert info">To learn about the scenarios where the SDK uses the media volume, see <a href="https://docs.agora.io/en/help/integration-issues/system_volume">What is the difference between the in-call volume and the media volume</a>.</div>

- If multiple external audio devices are connected, when the user removes the current playback device, the audio route is affected as follows:

  - With versions earlier than v3.5.0, the SDK does not play audio through any audio route, which causes a no-audio issue.
  - With v3.5.0 and later versions, the SDK sets the audio route as follows (in order of priority): the external device connected next to last > ... > the external device connected first > `setEnableSpeakerphone` > `setDefaultAudioRouteToSpeakerphone` > the default audio route of the SDK.

See <Link to="../advanced-features/set-audio-route">Set the Audio Route</Link> for Android platform.

#### New features

**Virtual background (beta)**

This release adds the `enableVirtualBackground` method, with which you can enable and set a virtual background for users as either a solid color or an image in PNG or JPG format. You can use the `VirtualBackgroundSourceEnabled` callback to learn whether the virtual background is successfully enabled or the reason for an error.

<div class="alert note">Before you use virtual backgrounds, ensure that the device performance and user scenarios meet the requirements. See <a href="https://api-ref.agora.io/en/video-sdk/react-native/3.x/classes/rtcengine.html#enablevirtualbackground">enableVirtualBackground</a > documentation.</div>

#### Improvements

**1. Video quality**

The following improvements have been made to the quality of captured and received video in this release:

- Enhance the video contrast of captured and received video by adapting the [color range](https://en.wikipedia.org/wiki/YCbCr) to moderate the video whiteness.
- Enhance the color richness of captured and received video by adapting the [color space](https://en.wikipedia.org/wiki/Color_space) to further restore video colors.
- Automatically enable the best video-capture strategy to optimize the quality of captured video (including resolution, frame rate, and color range). This improvement only applies to certain video with a capture resolution no higher than 1080P. (iOS only)
- Enable camera autofocus by default, and dynamically adjust the capture behavior to moderate overexposure. If you want to disable autofocus, call `setCameraAutoFocusFaceModeEnabled(false)`. (iOS only)


**2. Additional improvements**

This release also improves the following:

- The CPU usage and end-to-end video delay in high-resolution (720P and higher) scenarios are reduced. (Android only)
- In scenarios where the AGC is enabled, the convergence time for noise reduction is shortened, which reduces noise fluctuations.
- The smoothness of output frames in the custom video rendering scenario is improved.

#### Fixed issues

This release fixed the following issues:

**Android and iOS**

- After a remote user called `enableLoopbackRecording`, occasionally the local user heard an echo of their own audio. 
- After calling `muteLocalAudioStream(true)` to stop publishing a local audio stream, the local user could hear remote users when the local user joined a channel for the first time. After leaving the channel and joining another channel, occasionally the local user could not hear remote users.
- When the local network quality was poor, the downlink network quality rating (`rxQuality`) of remote users reported by the SDK was not accurate.

**Android only**

- Occasional failure to update the transcoding layout in Media Push under certain circumstances. 

**iOS only**

- In the meeting scenario, after a remote user enabled local audio capturing in the channel, occasionally the local user heard an echo of the remote userâ€™s audio.
- The value of `memoryTotalUsageRatio` reported by the `RtcStats` callback was not accurate.
- Occasional crashes.
- When `orientationMode` was set as `FixedPortrait`, the width and height of the video resolution was reversed, which caused the human face in video to be scaled up.


#### API changes

**Added**

- [`enableVirtualBackground`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/classes/rtcengine.html#enablevirtualbackground)
- [`VirtualBackgroundSourceEnabled`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/interfaces/rtcchannelevents.html#virtualbackgroundsourceenabled)

**Modified**

- [`setEnableSpeakerphone`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/classes/rtcengine.html#setenablespeakerphone)
- [`setDefaultAudioRouteToSpeakerphone`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/classes/rtcengine.html#setdefaultaudioroutetospeakerphone)


## v3.4.6

v3.4.6 was released on July 23, 2021.

#### Improvements

To improve the accuracy of face detection results, as of this release, the SDK triggers the `FacePositionChanged` callback immediately after detecting the disappearance of the human face.

#### Fixed issues

This release fixed the following issues:

**Android**
- Failed to enable the camera on certain Android 4.4 TV models. 
- Low-volume issues occurred when the user used Type-C headphones. 
- The `interface xxx is not visible from class loader` error when running a project on some Android devices. 

**iOS**
- Occasional crash during SDK initialization under certain circumstances.
- The missing `nonnull` and `_Nullable` modifiers in Objective-C header files caused warnings when the project was run.
- When `startAudioMixing` was called and a percent-encoding URL was passed in this method, the SDK failed to play the corresponding online audio file.

## v3.4.5 

v3.4.5 was released on July 15, 2021.

#### Compatibility changes

**1. API compatibility changes**

This release makes the following compatibility changes to APIs:
- Deprecates the `RtcEngineConfig` class and the `createWithConfig` method, and replaces them with the `RtcEngineContext` class and the `createWithContext` method. Compared with `RtcEngineConfig`, the data type of the `areaCode` property in `RtcEngineContext`changes from `AreaCode` to `AreaCode[]`, which supports setting multiple regions for connection.
- Renames the the following properties in the `RtcStats` interface:
  - `totalDuration` to `duration`
  - `users` to `userCount`   

 The data type and definition of the properties remain unchanged.
- Strictly distinguishes the mandatory and non-mandatory parameters in the constructors of all classes. For details, see <a href="#classchanges">Changes to class constructors</a>.

If you upgrade the SDK to v3.4.5 or later, to avoid affecting your service, ensure that you modify the implementation of these APIs.

**2. Support for GCM2 encryption**

To further improve the security during real-time audio and video transmission process, this release adds the following:

- `AES128GCM2` and `AES256GCM2` encryption modes in `EncryptionMode`. The new GCM encryption modes use a more secure KDF (Key Derivation Function) and support setting the key and salt.
- The `encryptionKdfSalt` member in `EncryptionConfig` to add the salt for the `AES128GCM2` and `AES256GCM2` encryption modes.

This release also changes the default encryption mode from `AES128XTS` to `AES128GCM2`. If you use the default encryption mode in earlier versions, after upgrading the SDK to v3.4.5, ensure that you call `enableEncryption` and set `EncryptionMode` to `AES128XTS`.

**3. Media stream publishing behavior changes**

To flexibly control the publishing state in multiple channels, this release optimizes the `RtcChannel` class as follows:

- Deprecates the `publish` and `unpublish` methods, and adds `muteLocalAudioStream` and `muteLocalVideoStream` instead. You can set the publishing state of the audio stream and video stream separately.
- Adds the `publishLocalAudio` and `publishLocalVideo` members in `ChannelMediaOptions`. You can set the publishing state when joining a channel.
- After calling `setClientRole(Broadcaster)`, the local user publishes audio and video streams by default.

<div class="alert note">The following APIs have the same function. If you call them together, the one called later takes effect.
<ul><li><code>publishLocalAudio = false</code> serves the same function as <code>muteLocalAudioStream(true)</code>.</li>
<li><code>publishLocalVideo = false</code> serves the same function as <code>muteLocalVideoStream(true)</code>.</li></ul></div>

The above improvements bring the following changes in the `RtcEngine` class:

- `muteLocalAudioStream` and `muteLocalVideoStream` of `RtcEngine` do not take effect for channels created by the `RtcChannel` class, so you need to use the `muteLocalAudioStream` and `muteLocalVideoStream` of the `RtcChannel` class instead.
- When a user joins a channel by using `joinChannel` with the `options` parameter, you can set the publishing state.
- If a user joins a channel by calling `joinChannel` with the `options` parameter, `muteLocalAudioStream` or `muteLocalVideoStream` only takes effect when it is called after `joinChannel`.

If you upgrade the SDK to v3.4.5 or later, to avoid affecting your service, Agora recommends modifying the implementation of `muteLocalAudioStream`, `muteLocalVideoStream`, `publish`, and `unpublish`.


#### Improvements

**1. Media Push**

To be more transparent to users about errors and events in Media Push, this release adds the following codes:

- To `RtmpStreamingStateChanged`: Error code `UnPublishOK (100)`, which reports that the streaming has been stopped normally. After you call `removePublishStreamUrl` to stop streaming, the SDK returns this error code and state code `Idle (0)`.
- To `RtmpStreamingEvent`: Event code `UrlAlreadyInUse (2)`, which reports that the streaming URL is already being used for Media Push. If you want to start new streaming, use a new streaming URL.

**2. Music file state**

When you call `startAudioMixing` after `pauseAudioMixing`, this release adds the `AudioMixingStateChanged(Playing,StartedByUser)`state, which indicates the music file is stopped, before reporting `AudioMixingStateChanged(Stopped,StoppedByUser)`.

**3. Audio device errors**

To convey the impact of a system call on the audio sampling, this release adds `Interrupted (8)` in `AudioLocalError`, which reports that the audio sampling is interrupted by a system call.


#### Fixed issues

This release fixed the following issues:

- Under poor network conditions, when you called `startAudioMixing` to play an online music file, occasionally the SDK response time was too long and caused a freeze.
- Under poor network conditions, when you frequently called `startAudioMixing` to play an online music file, an ANR pop-up window occasionally appeared.
- On some Android devices, after connecting a Bluetooth headset, the speaker still played audio.
- After switching the audio route to Bluetooth, the Bluetooth device occasionally failed to sample audio.
- Under poor network conditions, users were occasionally unable to switch roles.
- Under certain network conditions, when the host used a Xiaomi phone to custom capture video in texture format, other users in the channel saw the hostâ€™s video as a black screen.
- Occasionally, the user's view was upside down when the application was running on an M1 chip device. (iOS only)

#### API changes

**Added**

- [`RtcEngineContext`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/classes/rtcenginecontext.html) class
- [`createWithContext`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/classes/rtcengine.html#createwithcontext)
- [`UnPublishOK (100)`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/enums/rtmpstreamingerrorcode.html#unuublishok) in `RtmpStreamingErrorCode` 
- [`UrlAlreadyInUse (2)`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/enums/rtmpstreamingevent.html#urlalreadyinuse) in `RtmpStreamingEvent`
- `AES128GCM2 (7)` and `AES256GCM2 (8)`in [`EncryptionMode`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/enums/encryptionmode.html) 
- `encryptionKdfSalt` in [`EncryptionConfig`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/enums/encryptionmode.html)
- [`muteLocalAudioStream`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/classes/rtcchannel.html#mutelocalaudiostream) and [`muteLocalVideoStream`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/classes/rtcchannel.html#mutelocalvideostream) in `RtcChannel`
- [`publishLocalAudio`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/classes/channelmediaoptions.html#publishlocalaudio) and [`publishLocalVideo`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/classes/channelmediaoptions.html#publishlocalvideo) in `ChannelMediaOptions`
- [`Interrupted (8)`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/enums/audiolocalerror.html#interrupted) in `AudioLocalError`

**Modified**
This release renames the following properties in `RtcStats`:

- `totalDuration` to `duration`
- `users` to `userCount`

**Deprecated**

- `createWithConfig`
- `RtcEngineConfig` class
- `publish` and `unpublish` in `RtcChannel` 

<a name="classchanges"></a>
**Changes to class constructors**

To make the code more standardized and robust, as of v3.4.5, the Agora SDK strictly distinguishes between the mandatory and non-mandatory member properties of all classes, and this has required the class constructors to be modified.

This section lists all the classes that have undergone constructor changes in v3.4.5. If you upgrade the SDK to v3.4.5 or later, to avoid affecting your service, ensure that you modify the implementation of these classes.

- <a href="#videodimension">VideoDimensions</a>
- <a href="#agoraimage">AgoraImage</a>
- <a href="#transcodinguser">TranscodingUser</a>
- <a href="#channelmediainfo">ChannelMediaInfo</a>
- <a href="#rectangle">Rectangle</a>
- <a href="#watermarkoptions">WatermarkOptions</a>
- <a href="#cameracapturerconfiguration">CameraCapturerConfiguration</a>
- <a href="#channelmediaoptions">ChannelMediaOptions</a>
- <a href="#encryptionconfig">EncryptionConfig</a>
- <a href="#clientroleoptions">ClientRoleOptions</a>
- <a href="#datastreamconfig">DataStreamConfig</a>


<a name="videodimension"></a>
#### VideoDimensions

The following properties in the `VideoDimensions` class change from required to optional:

- `width`
- `height` 

The constructor of the `VideoDimensions` class changes as follows:

**Earlier than v3.4.5**

```typescript
new VideoDimensions(640, 360);
```
**As of v3.4.5**

```typescript
new VideoDimensions({width: 640, height: 360});
```

<a name="agoraimage"></a>
#### AgoraImage

The following properties in the `AgoraImage` class change from required to optional:
 - `x`
 - `y`
 - `width`
 - `height`

The constructor of the `AgoraImage` class changes as follows:

**Earlier than v3.4.5**

```typescript
new AgoraImage('url', 0, 0, 640, 360);
```
**As of v3.4.5**

```typescript
new AgoraImage('url', {x: 0, y: 0, width: 640, height: 360});
```

<a name="transcodinguser"></a>
#### TranscodingUser

The properties in the `TranscodingUser` class change from required to optional:
 - `x`
 - `y`

The constructor of the `TranscodingUser` class changes as follows:

**Earlier than v3.4.5**

```typescript
new TranscodingUser(0, 0, 0, {width: 640, height: 360, ...});
```
**As of v3.4.5**

```typescript
new TranscodingUser(0, {x: 0, y: 0, width: 640, height: 360, ...});
```

<a name="channelmediaInfo"></a>
#### ChannelMediaInfo

The `channelName` property in the `ChannelMediaInfo`  class changes from optional to required.

The constructor of the `ChannelMediaInfo` class changes as follows:

**Earlier than v3.4.5**

```typescript
new ChannelMediaInfo(0, {channelName: 'channelName', token: 'token'});
```
**As of v3.4.5**

```typescript
new ChannelMediaInfo('channelName', 0, {token: 'token'});
```

<a name="rectangle"></a>
#### Rectangle

The following properties in the `Rectangle` class change from required to optional:
 - `x`
 - `y`
 - `width`
 - `height`

The constructor of the `Rectangle` class changes as follows:

**Earlier than v3.4.5**

```typescript
new Rectangle(0, 0, 640, 360);
```
**As of v3.4.5**

```typescript
new Rectangle({x: 0, y: 0, width: 640, height: 360});
```

<a name="watermarkoptions"></a>
#### WatermarkOptions

The following properties in the `WatermarkOptions` class change from required to optional:
 - `positionInLandscapeMode`
 -  `positionInPortraitMode`

The constructor of the `WatermarkOptions` class changes as follows:

**Earlier than v3.4.5**

```typescript
new WatermarkOptions(Rectangle, Rectangle, true);
```
**As of v3.4.5**

```typescript
new WatermarkOptions({visibleInPreview: true, positionInLandscapeMode: Rectangle, positionInPortraitMode: Rectangle});
```

<a name="cameracapturerconfiguration"></a>
#### CameraCapturerConfiguration

The following properties in the `CameraCapturerConfiguration` class change from required to optional:
 - `preference`
 -  `cameraDirection`

The constructor of the `CameraCapturerConfiguration` class changes as follows:

**Earlier than v3.4.5**

```typescript
new CameraCapturerConfiguration(CameraCaptureOutputPreference, CameraDirection, {captureWidth: 640, captureHeight: 360});
```
**As of v3.4.5**

```typescript
new CameraCapturerConfiguration({preference: CameraCaptureOutputPreference, captureWidth: 640, captureHeight: 360, cameraDirection: CameraDirection});
```

<a name="channelmediaoptions"></a>
#### ChannelMediaOptions

The following properties in the `ChannelMediaOptions` class change from required to optional:
 - `autoSubscribeAudio`
 -  `autoSubscribeVideo`

The constructor of the `ChannelMediaOptions` class changes as follows:

**Earlier than v3.4.5**

```typescript
new ChannelMediaOptions(true, true);
```
**As of v3.4.5**

```typescript
new ChannelMediaOptions({autoSubscribeAudio: true, autoSubscribeVideo: true});
```

<a name="encryptionconfig"></a>
#### EncryptionConfig

The following properties in the `EncryptionConfig` class change from required to optional:
 - `encryptionMode`
 -  `encryptionKey`

The constructor of the `EncryptionConfig` class changes as follows:

**Earlier than v3.4.5**

```typescript
new EncryptionConfig(EncryptionMode, 'encryptionKey');
```
**As of v3.4.5**

```typescript
new EncryptionConfig({encryptionMode: EncryptionMode, encryptionKey: 'encryptionKey'});
```

<a name="clientroleoptions"></a>
#### ClientRoleOptions

The `audienceLatencyLevel` property in the  `ClientRoleOptions` class changes from required to optional.

The constructor of the  `ClientRoleOptions` class changes as follows:

**Earlier than v3.4.5**

```typescript
new ClientRoleOptions(AudienceLatencyLevelType);
```
**As of v3.4.5**

```typescript
new ClientRoleOptions({audienceLatencyLevel: AudienceLatencyLevelType});
```

<a name="datastreamconfig"></a>
#### DataStreamConfig

The following properties in the `DataStreamConfig` class change from optional to required:
- `syncWithAudio`
- `ordered`

The constructor of the `DataStreamConfig` class changes as follows:

**Earlier than v3.4.5**

```typescript
new DataStreamConfig({syncWithAudio: true, ordered: true});
```
**As of v3.4.5**

```typescript
new DataStreamConfig(true, true);
```

## v3.4.2

v3.4.2 was released on May 25, 2021.

#### Compatibility changes

**Integration changes**

1. SDK package publishing platform (on Android only)

Because JCenter is about to retire, Agora publishes the <Vg k="VSDK" /> Android SDK package to JitPack instead of JCenter. Therefore, to build an Android application, add the following line in the `/android/build.gradle` file of your project:

```
allprojects {
    repositories {
        ...
        maven { url 'https://www.jitpack.io' }
    }
}
```

<div class="alert info">If the build fails, try replacing <code>'https://www.jitpack.io'</code> with <code>'https://jitpack.io'</code>.</div>


2. Extension libraries

To reduce the app size after integrating the SDK, this release packages some features as extension libraries (with the `Extension` suffix). For details, see [Extension libraries](https://docs.agora.io/en/help/integration-issues/reduce_app_size_rtc). If you do not need to use the related features, you can remove the corresponding extension libraries and recompile the project.

**Behavior changes**

To monitor the reason why the playback state of a music file changes, this release modifies the `AudioMixingStateChanged` callback as follows:

- Replaces the `errorCode` parameter with the `reason` parameter.
- Deprecates `AudioMixingErrorCode` and replace it with `AudioMixingReason`. Using `AudioMixingReason`, you can get the reason for the change of the playback state, such as start, pause, stop or fail.
- Modifies some logic of reporting `AudioMixingStateCode`. For example, as of this release, when looping music, the SDK triggers the `Playing` state when each loop is completed or starts.

If you upgrade the SDK to v3.4.2 or later, to avoid affecting your service, Agora recommends that you modify the implementation of `AudioMixingStateChanged`.

#### New features

**1. Virtual metronome**

To meet the needs of online teaching scenarios that would benefit from a metronome, this release adds the following methods:

- `startRhythmPlayer`: Enables the virtual metronome.
- `stopRhythmPlayer`: Disables the virtual metronome.
- `configRhythmPlayer`: Reconfigures the virtual metronome after it is enabled.

**2. Playback progress of audio effect files**

To control the playback progress of audio effect files, this release adds the following methods or parameters:

- `setEffectPosition`: Sets the playback position after starting playback of an audio effect file.
- `getEffectDuration`: Gets the duration of a local audio effect file.
- `getEffectCurrentPosition`: Gets current playback progress of an audio effect file.
- `startPos` in `playEffect`: Sets the playback position when starting playback of an audio effect file.

#### Improvements

**1. Local file path (on Android only)**

To meet the requirements of Google Play Store, this release supports accessing a local file through URIs. When you call `startAudioMixing`, `startAudioRecordingWithConfig`, `getAudioMixingDuration`, `preloadEffect`, `playEffect`, `getEffectDuration`, or `addVideoWatermark` and need to access a local file, Agora recommends the following steps:

1. Use [Storage Access Framework](https://developer.android.com/guide/topics/providers/document-provider) to get the URI of the local file.
2. Call [`Uri.toString`](https://developer.android.com/reference/android/net/Uri#toString()) to convert the URI to a string.
3. Pass the string in the `filePath` or `watermarkUrl` parameter.

**2. Video encoding**

The Agora SDK allows you to use `DegradationPreference` to set the degradation preference of local video encoding under limited bandwidth, for example, reducing the video frame rate while maintaining video quality, or reducing the video quality while maintaining the video frame rate. As of this release, `DegradationPreference` can be set as `Balanced`, which reduces the video frame rate and video quality simultaneously to strike a balance between smoothness and video quality. `Balanced` is suitable for scenarios where both smoothness and video quality are a priority, such as one-to-one calls, one-to-one online teaching, and multi-user online meetings.

**3. Playback progress of music files**

To control the playback progress of music files, this release is optimized as follows:

- Adds the `startPos` parameter in `startAudioMixing`, which allows you to set the playback position when starting playback of a music file.
- Adds the `filePath` parameter in `getAudioMixingDuration`, which allows you to get the duration of a local music file before playing it.

**4. Audio recording**

To set the recording configuration during audio recording, this release adds the `startAudioRecordingWithConfig` method and deprecates the `startAudioRecording` method. The `config` parameter of `startAudioRecordingWithConfig` allows you to set the audio recording quality, content, sample rate, and storage path of the recording file.

This release also adds a new error code: `AlreadyInRecording(160)`. If you call `startAudioRecordingWithConfig` again before the current recording ends, the SDK reports this error code.

**5. Media device errors**

To help users better understand the cause of local video errors, this release adds a new error code to `LocalVideoStreamError`: `DeviceNotFound(8)`, which indicates that the SDK cannot find the local video-capture device.

#### Fixed issues

This release fixed the following issues:

- Crashes occurred when the audio sample rate exceeded 4.8 kHz.
- The `AudioVolumeIndication` callback returned incorrect volume information after you called `enableSoundPositionIndication(true)`.
- The local user would see the remote video upside down for an instant when the remote user switched between the front and rear cameras.
- Crashes occurred in a certain voice conversion scenario.
- Under extremely poor network conditions, the host's video sent from the Web clients was corrupted on the Native clients.
- Remote users saw a distorted image when the local user minimized the shared screen with the genie effect on Mac devices.
- Joining the channel occasionally failed when a user switched back to the app after keeping it in the background for a long time. (On iOS only)
- The user interface of the application got stuck when you called `destroy` or the `get` method such as `getCallId` or `getSdkVersion` after calling `setupLocalVideo` or `setupRemoteVideo`. (On iOS only)
- Occasional crashes. (On iOS only)
- The received custom video frame was rotated under certain circumstances. (On Android only)

#### API changes

**Added**

- [`startRhythmPlayer`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/classes/rtcengine.html#startrhythmplayer)
- [`stopRhythmPlayer`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/classes/rtcengine.html#stoprhythmplayer)
- [`configRhythmPlayer`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/classes/rtcengine.html#configrhythmplayer)
- [`startAudioRecordingWithConfig`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/classes/rtcengine.html#startaudiorecordingwithconfig)
- [`getEffectDuration`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/classes/rtcengine.html#geteffectduration)
- [`setEffectPosition`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/classes/rtcengine.html#seteffectposition)
- [`getEffectCurrentPosition`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/classes/rtcengine.html#geteffectcurrentposition)
- `filePath` in [`getAudioMixingDuration`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/classes/rtcengine.html#getaudiomixingduration)
- `startPos` in [`playEffect`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/classes/rtcengine.html#playeffect)
- `startPos` in [`startAudioMixing`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/classes/rtcengine.html#startaudiomixing)
- `DeviceNotFound(8)` in [`LocalVideoStreamError`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/enums/localvideostreamerror.html)
- [`Error code`](../reference/error-codes): `AlreadyInRecording(160)`

**Modified**

- [`AudioMixingStateChanged`]((https://api-ref.agora.io/en/video-sdk/react-native/3.x/interfaces/rtcengineevents.html#audiomixingstatechanged))

**Deprecated**

- `startAudioRecording`
- `AudioMixingErrorCode`

## v3.3.1

v3.3.1 was released on March 12, 2020.

#### Compatibility changes

This release deprecates `setDefaultMuteAllRemoteAudioStreams` and `setDefaultMuteAllRemoteVideoStreams `and changes the behavior of `mute`-related methods as follows:

- `mute`-related methods must be called after joining or switching to a channel; otherwise, the method call does not take effect.
- Methods with the prefix `muteAll` are no longer the master switch, and each `mute`-related method independently controls the user's subscribing state. When you call methods with the prefixes `muteAll` and `muteRemote` together, the method that is called later takes effect.
- Methods with the prefix `muteAll` set whether to subscribe to the audio or video streams of all remote users, including all subsequent users, which means methods with the prefix `muteAll` contain the function of methods with the prefix `setDefaultMute`. Agora recommends not calling methods with the prefixes `muteAll` and `setDefaultMute` together; otherwise, the setting may not take effect.

#### New features

**1. Channel media options**

To help developers control media subscription more flexibly, this release adds the `options` parameter to `joinChannel` and `switchChannel` methods to set whether users subscribe to all remote audio or video streams in a channel when joining and switching channels.

**2. Cloud proxy**

To improve the usability of the Agora Cloud Proxy, this release adds the `setCloudProxy` method to set the cloud proxy and allows you to select a cloud proxy that uses the UDP protocol. For details, see [Cloud Proxy](../basic-features/use-cloud-proxy).

**3. Deep-learning noise reduction**

To eliminate non-stationary noise based on traditional noise reduction, this release adds `enableDeepLearningDenoise` to enable deep-learning noise reduction.

**4. Singing beautifier**

To beautify the voice and add reverberation effects in a singing scenario, this release adds the `setVoiceBeautifierParameters` method and adds the `SingingBeautifier` constant to `VoiceBeautifierPreset`.

You can call `setVoiceBeautifierPreset(SingingBeautifier)` to beautify the male voice and add the reverberation effect for a voice in a small room. For more settings, you can call `setVoiceBeautifierParameters(SingingBeautifier, param1, param2)` to beautify male or female voices and add reverberation effects for a voice in a small room, large room, or hall.

**5. Log files**

To ensure the integrity of log content, this release adds the `createWithConfig` method and adds the `logConfig` property to the `log` parameter. You can use `logConfig` to set the log files output by the Agora SDK when you initialize `RtcEngine`. See [How can I set the log file?](https://docs.agora.io/en/help/integration-issues/log) for details.

As of v3.3.1, Agora does not recommend using the `setLogFile`, `setLogFileSize`, or `setLogFilter` methods to set the log files.

**6. Quality of captured video**

To control the quality of video captured by the local camera, this release adds support for customizing the capture resolution and listening for abnormalities.

- Customize the capture resolution: Call the `setCameraCapturerConfiguration` method to set the capture preference to `Manual(3)` and set the width and height of the captured video image.
- Listen for abnormalities:
  - The abnormal brightness level of captured video images: Use `captureBrightnessLevel` in the `localVideoStats` callback.
  - The camera fails to output the captured video: Use the `localVideoStateChanged(Failed, CaptureFailure)` callback.
  - The camera repeatedly outputs the captured video: Use the `localVideoStateChanged(Capturing, CaptureFailure)` callback.

(iOS only) To improve the user experience, this release adds the following reasons for local video capture errors in the `localVideoStateChanged` callback:

- `CaptureInBackGround(6)`: The application is running in the background.
- `CaptureMultipleForegroundApps(7)`: The application is running in Slide Over, Split View, or Picture in Picture mode.

**7. Data streams**

To support scenarios such as lyrics synchronization and courseware synchronization, this release deprecates the previous `createDataStream` method and replaces it with `createDataStreamWithConfig`. You can use this new method to create a data stream and set whether to synchronize the data stream with the audio stream sent to the Agora channel and whether the received data is ordered.

**8. Voice Conversion**

This release adds the `setVoiceConversionPreset` method to set a voice conversion effect (to disguise a user's voice). You can use this method to make a male-sounding voice sound steady or deep, and a female-sounding voice sound gender-neutral or sweet.


#### Improvements

**1. AES-GCM encryption mode**

For scenarios requiring high security, to guarantee the confidentiality, integrity, and authenticity of data, and to improve the computational efficiency of data encryption, this release adds the following enumerators in `EncryptionMode`:

- `AES128GCM`: 128-bit AES encryption, GCM mode.
- `AES256GCM`: 256-bit AES encryption, GCM mode.

<div class="alert note">Once you enable the built-in encryption, all users in the same channel must use the same encryption mode and key, including the server-side users such as the Agora recording service.</div>

**2. Remote audio statistics**

To monitor quality of experience (QoE) of the local user when receiving a remote audio stream, this release adds:
- `mosValue` to `remoteAudioStats`, which reports the quality of the remote audio stream as determined by the Agora real-time audio MOS (Mean Opinion Score) measurement system.
- `qoeQuality` and `qualityChangedReason` to `remoteAudioStats`, which report QoE of the local user and the reason for poor QoE, respectively.

#### Issues fixed

**Android**

- The audio sampling failed on some Android devices after a headset was plugged in.
- Local audio sampling occasionally failed on Android 10.
- After enabling the sound position indication, you could not get the remote user's volume by the `audioVolumeIndication` callback.
- Occasional abnormality with the hardware encoders on certain devices after continuously encoding key frames for a short period of time.

**iOS**

- After enabling the sound position indication, you could not get the remote user's volume by the `audioVolumeIndication` callback.
- Occasional crashes when you called `enableLocalVideo(false)` while the application window was switching to Slide Over, Split View, or Picture in Picture mode.

#### API changes

This release adds the following APIs:

**Added**

- [`createWithConfig`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/classes/rtcengine.html#createwithconfig)
- [`setVoiceConversionPreset`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/classes/rtcengine.html#setvoiceconversionpreset)
- `AES128GCM` and `AES256GCM` in [`EncryptionMode`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/enums/encryptionmode.html)
- `mosValue` in [`RemoteAudioStats`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/interfaces/rtcengineevents.html#remoteaudiostats)
- [`setVoiceBeautifierParameters`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/classes/rtcengine.html#setvoicebeautifierparameters)
- `SingingBeautifier` in [`VoiceBeautifierPreset`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/enums/voicebeautifierpreset.html)
- [`enableDeepLearningDenoise`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/classes/rtcengine.html#enabledeeplearningdenoise)
- `options` in [`joinChannel`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/classes/rtcengine.html#joinchannel)
- `options` in [`switchChannel`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/classes/rtcengine.html#switchchannel)
- [`createDataStreamWithConfig`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/classes/rtcengine.html#createdatastreamwithconfig)
- `qoeQuality` and `qualityChangedReason` in [`RemoteAudioStats`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/interfaces/rtcengineevents.html#remoteaudiostats)
- [`setCloudProxy`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/classes/rtcengine.html#setcloudproxy)
- The `captureBrightnessLevel` property in the [`LocalVideoStats`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/interfaces/localvideostats.html)
- The `captureWidth` and `captureHeight` properties in the [`CameraCapturerConfiguration`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/classes/cameracapturerconfiguration.html) class
- `Manual(3)` in  [`CameraCaptureOutputPreference`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/enums/cameracaptureoutputpreference.html)
- `CaptureInBackGround(6)` and `CaptureMultipleForegroundApps(7)` in [`LocalVideoStreamError`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/enums/localvideostreamerror.html)
- Error code: [`ModuleNotFound(157)`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/enums/errorcode.html)

**Deprecated**

- `createWithAreaCode`
- `setDefaultMuteAllRemoteVideoStreams`
- `setDefaultMuteAllRemoteAudioStreams`
- `setLogFile`
- `setLogFileSize`
- `setLogFilter`
- `createDataStream`

## v3.2.1

v3.2.1 was released on December 23, 2020.

#### Compatibility changes

**1. Cloud proxy**

This release optimizes the Agora cloud proxy architecture. If you are already using cloud proxy, to avoid compatibility issues between the new SDK and the old cloud proxy, please contact [support@agora.io](mailto:support@agora.io) before upgrading the SDK. See [Cloud Proxy](../basic-features/use-cloud-proxy).

**2. Security and compliance**

Agora has passed ISO 27001, ISO 27017, and ISO 27018 international certifications, providing safe and reliable real-time interactive cloud services for users worldwide. See [ISO Certificates](../reference/security#iso-certificates).

This release supports transport layer encryption by adding TLS (Transport Layer Security) and UDP (User Datagram Protocol) encryption methods.

####  New features

**Interactive live streaming standard**

This release adds `options` in `setClientRole` for setting the latency level of an audience member. You can use this method to switch between Interactive Live Streaming Premium and Interactive Live Streaming Standard as follows:

- Set the latency level as ultra low latency to use Interactive Live Streaming Premium.
- Set the latency level as low latency to use Interactive Live Streaming Standard.

For details, see the [product overview](../introduction/product-overview) of Interactive Live Streaming Standard.

#### Improvements

**1. Meeting scenario**

To improve the audio experience for multi-person meetings, this release adds `MEETING(8)` in `setAudioProfile`.

**2. Voice beautifier and audio effects**

To improve the usability of the APIs related to voice beautifier and audio effects, this release deprecates `setLocalVoiceChanger` and `setLocalVoiceReverbPreset`, and adds the following methods instead:

- `setVoiceBeautifierPreset`: Compared with `setLocalVoiceChanger`, this method deletes audio effects such as a little boyâ€™s voice and a more spatially resonant voice.
- `setAudioEffectPreset`: Compared with `setLocalVoiceReverbPreset`, this method adds audio effects such as the 3D voice, the pitch correction, a little boyâ€™s voice and a more spatially resonant voice.
- `setAudioEffectParameters`: This method sets detailed parameters for a specified audio effect. In this release, the supported audio effects are the 3D voice and pitch correction.

**3. Interactive streaming delay**

This release reduces the latency on the audience's client during an interactive live streaming by about 500 ms.

#### Issues fixed

**Android**

- Occasional audio sampling issues with Xiaomi speakers.
- When a remote user called with vivo X30, the local user saw a black screen.
- When a remote user frequently joined and left a channel on an Android TV, the local user occasionally saw a black screen.
- Crashes occurred when using IPv6.
- After you called `enableEncryption`, the SDK did not trigger the `FirstLocalVideoFramePublished` callback.
- When Native clients integrated with the Agora Voice SDK interoperated with Web clients, the Web clients continuously reported the `Client.on(disable-local-video)` or `Client.on(mute-video)` callback.

**iOS**

- On iPhone 5s and iPhone 6, after the user enabled the basic image enhancement function, the screen flickered when users switched between apps.
- The `stopChannelMediaRelay` method did not take effect.
- The SDK mistakenly returned the `AdmStartRecording(1012)` error.
- Crashes occurred when using IPv6.
- After you called `enableEncryption`, the SDK did not trigger the `FirstLocalVideoFramePublished` callback.
- When Native clients integrated with the Agora Voice SDK interoperated with Web clients, the Web clients continuously reported the `Client.on(disable-local-video)` or `Client.on(mute-video)` callback.

#### API changes

**Added**

- `options`in [`setClientRole`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/classes/rtcengine.html#setclientrole)
- [`setAudioEffectPreset`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/classes/rtcengine.html#setaudioeffectpreset)
- [`setVoiceBeautifierPreset`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/classes/rtcengine.html#setvoicebeautifierpreset)
- [`setAudioEffectParameters`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/classes/rtcengine.html#setaudioeffectparameters)
- `MEETING(8)` in [`AudioScenario`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/enums/audioscenario.html)

**Deprecated**

- `setLocalVoiceChanger`
- `setLocalVoiceReverbPreset`

## v3.1.2 

v3.1.2 was released on September 28, 2020. 

**Compatibility changes**

#### 1. Disabling the local network connection quality report (iOS only)

To improve user experience, this version disables the local network connection quality report by default, to prevent the prompt to find local network devices from popping up when an end user launches the app on an iOS 14.0 device. The [gatewayRtt](https://api-ref.agora.io/en/video-sdk/ios/3.x/Classes/AgoraChannelStats.html#//api/name/gatewayRtt) parameter in the [`RtcStats`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/interfaces/rtcstats.html) callback is disabled by default. Do not use [[gatewayRtt](https://api-ref.agora.io/en/video-sdk/ios/3.x/Classes/AgoraChannelStats.html#//api/name/gatewayRtt)](https://api-ref.agora.io/en/video-sdk/react-native/3.x/interfaces/rtcstats.html#gatewayrtt) to obtain the round-trip delay between the client and the local router. See the [FAQ](https://docs.agora.io/en/help/integration-issues/local_network_privacy) for details.

If you don't mind the prompt, and want to enable the [gatewayRtt](https://api-ref.agora.io/en/video-sdk/ios/3.x/Classes/AgoraChannelStats.html#//api/name/gatewayRtt) parameter, please contact Agora technical support via [support@agora.io](mailto:support@agora.io).

#### 2. Regional connection

This release changes the `AreaCode` for regional connection. The latest area codes are as follows:

- `CN`: Mainland China.
- `NA`: North America.
- `EU`: Europe.
- `AS`: Asia, excluding Mainland China.
- `JP`: Japan.
- `IN`: India.
- `GLOB`: (Default) Global.

If you have specified a region for connection when calling `createWithAreaCode`, ensure that you use the latest area code when migrating from an earlier SDK version.

**New features**

#### 1. Publishing and subscription states

This release adds the following callbacks to report the current publishing and subscribing states:

- `AudioPublishStateChanged`: Reports the change of the audio publishing state.
- `VideoPublishStateChanged`: Reports the change of the video publishing state.
- `AudioSubscribeStateChanged`: Reports the change of the audio subscribing state.
- `VideoSubscribeStateChanged`: Reports the change of the video subscribing state.

#### 2. First local frame published callback

This release adds the `FirstLocalAudioFramePublished` and `FirstLocalVideoFramePublished` callbacks to report that the first audio or video frame is published. The `FirstLocalAudioFrame` callback is deprecated from v3.1.2.

**Improvement**

#### 1. Media Push

This release adds the `RtmpStreamingEvent` callback to report events during Media Push, such as failure to add a background image or watermark image.

#### 2. Encryption

This release adds the `enableEncryption` method for enabling built-in encryption, and deprecates the following methods:

- `setEncryptionSecret`
- `setEncryptionMode`

#### 3. More in-call statistics

This release adds the following attributes to provide more in-call statistics:

- Adds `txPacketLossRate` in `LocalAudioStats`, which represents the audio packet loss rate (%) from the local client to the Agora edge server before applying anti-packet loss strategies.

- Adds the following attributes in `LocalVideoStats`:
  - `txPacketLossRate`: The video packet loss rate (%) from the local client to the Agora edge server before applying anti-packet loss strategies.
  - `captureFrameRate`: The capture frame rate (fps) of the local video.
- Adds `publishDuration` in `RemoteAudioStats` and `RemoteVideoStats`, which represents the total publish duration (ms) of the remote media stream.

#### 4. Audio profile

To improve audio performance, this release adjusts the maximum audio bitrate of each audio profile as follows:

| Profile                  | v3.1.2                                                       | Earlier than v3.1.2                                          |
| :----------------------- | :----------------------------------------------------------- | :----------------------------------------------------------- |
| `Default`                | For the interactive streaming profile: 64 Kbps<br/>For the communication profile: 18 Kbps | For the interactive streaming profile: 52 Kbps<br/>For the communication profile: 18 Kbps |
| `SpeechStandard`         | 18 Kbps                                                      | 18 Kbps                                                      |
| `MusicStandard`          | 64 Kbps                                                      | 48 Kbps                                                      |
| `MusicStandardStereo`    | 80 Kbps                                                      | 56 Kbps                                                      |
| `MusicHighQuality`       | 96 Kbps                                                      | 128 Kbps                                                     |
| `MusicHighQualityStereo` | 128 Kbps                                                     | 192 Kbps                                                     |

#### 5. Log files

This release increases the default number of log files that the Agora SDK outputs from 2 to 5, and increases the default size of each log file from 512 KB to 1024 KB. By default, the SDK outputs five log files, `agorasdk.log`, `agorasdk_1.log`, `agorasdk_2.log`, `agorasdk_3.log`, `agorasdk_4.log`. The SDK writes the latest logs in `agorasdk.log`. When `agorasdk.log` is full, the SDK deletes the log file with the earliest modification time among the other four, renames `agorasdk.log` to the name of the deleted log file, and creates a new `agorasdk.log` to record the latest logs.

#### 6. Underlying implementation of TextureView

This release changes the underlying implementation of the `TextureView` object, from instantiating a `TextureView` object to creating a `TextureView` object with the `CreateTextureView` method.

#### 7. Others

- Reduces the audio delay.
- Reduces the playback time of the first remote audio frame.
- This release improves the performance of some iOS models (using Apple A10 and below chips), reducing CPU utilization and memory footprint.
- In-ear monitoring improvement on OPPO models (Android):
  - Reno4 Pro 5G
  - Reno4 5G

**Issues fixed**

This release fixed the following issues:

- The `FirstLocalVideoFrame` and `FirstRemoteVideoFrame` callbacks are not triggered at the right time.
- `setAudioMixingPitch` did not work when setting the `pitch` parameter to certain values.
- The image enhancement feature does not work.
- For Android:
  - Occasional video freeze.
  - Crashes on x86 phones running on Android 6 and later.
- For iOS:
  - When a remote user leaves the channel, the view of the remote user becomes black.
  - Occasional audio freeze when disconnecting from a Bluetooth device.
  - Occasional crashes when the user left the channel after talking in multiple channels.

**API changes**

#### Added


- [`AudioPublishStateChanged`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/interfaces/rtcengineevents.html#audiopublishstatechanged)
- [`VideoPublishStateChanged`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/interfaces/rtcengineevents.html#videopublishstatechanged)
- [`AudioSubscribeStateChanged`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/interfaces/rtcengineevents.html#audiosubscribestatechanged)
- [`VideoSubscribeStateChanged`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/interfaces/rtcengineevents.html#videosubscribestatechanged)
- [`FirstLocalAudioFramePublished`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/interfaces/rtcengineevents.html#firstlocalaudioframepublished)
- [`FirstLocalVideoFramePublished`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/interfaces/rtcengineevents.html#firstlocalvideoframepublished)
- [`enableEncryption`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/classes/rtcengine.html#enableencryption)
- [`txPacketLossRate`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/interfaces/localaudiostats.html#txpacketlossrate) in [`LocalAudioStats`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/interfaces/localaudiostats.html)  class
- [`txPacketLossRate`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/interfaces/localvideostats.html#txpacketlossrate)  and  [`captureFrameRate`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/interfaces/localvideostats.html#captureframerate) in [`LocalVideoStats`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/interfaces/localvideostats.html) class
- `publishDuration` in [`RemoteAudioStats`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/interfaces/remoteaudiostats.html) and  [`RemoteVideoStats` ](https://api-ref.agora.io/en/video-sdk/react-native/3.x/interfaces/remotevideostats.html) class
- [`RtmpStreamingEvent`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/interfaces/rtcengineevents.html#rtmpstreamingevent)
- Error code: [`NoServerResources(103)`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/enums/errorcode.html#noserverresources)
- Warning code:
  - [`AdmCategoryNotPlayAndRecord(1029)`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/enums/warningcode.html#admcategorynotplayandrecord)
  - [`AdmNoDataReadyCallback(1040)`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/enums/warningcode.html#admnodatareadycallback)
  - [`AdmInconsistentDevices(1042)`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/enums/warningcode.html#adminconsistentdevices)
  - [`ApmResidualEcho(1053)`](https://api-ref.agora.io/en/video-sdk/react-native/3.x/enums/warningcode.html#apmresidualecho)

#### Deprecated

- `setEncryptionSecret`
- `setEncryptionMode`
- `FirstLocalAudioFrame`

#### Deleted

- Warning code: `AdmImproperSettings(1053)`

## v3.0.1

v3.0.1 was released on September 4th, 2020.

**Functions and features**

- Adapts to Agora <Vg k="VSDK" /> v3.0.1.
- Supports asynchronous programming with Promises.
- Supports multiple channels.
- Supports TextureView on Android platform.

Agora provides an open-source [Agora React Native Quickstart](https://github.com/AgoraIO-Community/Agora-RN-Quickstart) on GitHub.

</PlatformWrapper>